<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transformers.js v4.0.0-next.4 Hub Tool</title>
</head>
<body style="font-family: sans-serif; line-height: 1.6; padding: 20px; color: #333; max-width: 850px; margin: auto; background: #fff;">

    <h2 style="color: #2563eb; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Model Hub Inspector</h2>
    
    <div style="background: #f8fafc; border: 1px solid #e2e8f0; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
        <label style="font-weight: bold;">Enter Hugging Face Model ID:</label><br>
        <input type="text" id="myModelInput" value="Xenova/all-MiniLM-L6-v2" style="padding: 10px; width: 70%; border: 1px solid #cbd5e1; border-radius: 5px; margin-top: 10px;">
        <button onclick="myGetModelInfo()" style="padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">Inspect Folder</button>
    </div>

    <div id="mySummaryBox" style="display: none; margin-bottom: 20px; padding: 15px; background: #ecfdf5; border: 1px solid #10b981; border-radius: 8px;">
        <strong>Total Repo Size:</strong> <span id="myTotalSize">0</span> MB<br>
        <strong>Total Files:</strong> <span id="myFileCount">0</span>
    </div>

    <div id="myResultsList" style="white-space: pre-wrap; font-family: monospace; background: #1e293b; color: #f8fafc; padding: 15px; border-radius: 8px; font-size: 0.85em; max-height: 400px; overflow-y: auto;">
        Results will appear here...
    </div>

    <script type="module">
        // Using the updated next.4 CDN
        import { get_model_metadata } from 'https://cdn.jsdelivr.net/npm/@huggingface/transformers@4.0.0-next.4';

        const myResultsDiv = document.getElementById('myResultsList');
        const mySummary = document.getElementById('mySummaryBox');

        window.myGetModelInfo = async function() {
            const myModelName = document.getElementById('myModelInput').value;
            myResultsDiv.innerText = "Fetching folder details...";
            mySummary.style.display = "none";

            try {
                // get_model_metadata returns the full directory info from HF Hub
                const myData = await get_model_metadata(myModelName);
                
                let myTotalBytes = 0;
                let myFileDetails = "";

                // Each 'sibling' is a file in the repository
                myData.siblings.forEach(myFile => {
                    const mySizeMB = myFile.size ? (myFile.size / (1024 * 1024)).toFixed(2) : "0.00";
                    myTotalBytes += (myFile.size || 0);
                    
                    myFileDetails += `ðŸ“„ ${myFile.rfilename.padEnd(40)} | ${mySizeMB} MB\n`;
                });

                // Update the Summary UI
                document.getElementById('myTotalSize').innerText = (myTotalBytes / (1024 * 1024)).toFixed(2);
                document.getElementById('myFileCount').innerText = myData.siblings.length;
                mySummary.style.display = "block";

                // Update the detailed list
                myResultsDiv.innerText = `Folder Contents for: ${myModelName}\n` + 
                                       `------------------------------------------------------------\n` +
                                       myFileDetails;

            } catch (myError) {
                myResultsDiv.innerText = "Error fetching data: " + myError.message + 
                    "\n\nMake sure the Model ID is correct (e.g., 'onnx-community/t5-small').";
            }
        };
    </script>
</body>
</html>
